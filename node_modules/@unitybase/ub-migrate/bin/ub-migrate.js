#!/usr/bin/env ub

const {options, argv} = require('@unitybase/base')
const {exec} = require('..')

const opts = options
  .describe('migrate', 'Migrate domain entities using scripts in `_data` directories', 'ub-migrate')
  .add(argv.establishConnectionFromCmdLineAttributes._cmdLineParams)
  .add({
    short: 'm',
    long: 'models',
    param: 'models',
    defaultValue: '*',
    help: 'Specify comma-separated list of models to migrate'
  })
  .add({
    short: 's',
    long: 'skip',
    param: 'skipModels',
    defaultValue: '*',
    help: 'Specify comma-separated list of models to skip, is ignored if "model" option used'
  }).add({
    short: 'v',
    long: 'verbose',
    defaultValue: false,
    help: 'Verbose mode'
  }).add({
    short: 'l',
    long: 'silent',
    defaultValue: false,
    help: 'Silent mode'
  }).add({
    short: 'tid',
    long: 'tenantID',
    defaultValue: NaN,
    param: 'tenantID',
    help: 'Tenant ID to initialize.  If not specified, all tenants will be iterated.'
  })

const cfg = opts.parseVerbose({}, true)
if (!cfg) {
  return
}

exec(cfg)
